{% extends "base.html" %}
{% block title %}Item Details{% endblock %}

<p class="text-muted small">
  DEBUG â†’ status: {{ item.status }},
  owner_id: {{ item.user_id }},
  current_user: {{ current_user.id if current_user.is_authenticated else 'no-user' }}
</p>


{% block content %}
<div class="container my-5">
  <div class="row">
    
    <!-- IMAGE -->
    <div class="col-md-5">
      <div class="card shadow-sm">
        {% if item.image %}
        <img src="{{ url_for('static', filename='uploads/' ~ item.image) }}"
             class="card-img-top"
             alt="Item Image">
        {% else %}
        <img src="https://via.placeholder.com/500x350"
             class="card-img-top"
             alt="No Image">
        {% endif %}
      </div>
    </div>

    <!-- DETAILS -->
    <div class="col-md-7">
      <div class="card shadow-sm p-4 h-100">
        {% if item.item_type == "lost" %}
          <span class="badge bg-danger mb-2">Lost</span>
        {% else %}
          <span class="badge bg-success mb-2">Found</span>
        {% endif %}

        <h3>{{ item.item_name }}</h3>

        <p class="text-muted">
          <strong>Category:</strong> {{ item.category }} <br>
          <strong>Location:</strong> {{ item.location }} <br>
          <strong>Date:</strong> {{ item.date_reported.strftime('%d %b %Y') }}
        </p>

        <p>{{ item.description }}</p>

        <hr>

        {% if current_user.is_authenticated %}
  <p>
    <strong>Contact:</strong> {{ item.contact }}
  </p>
{% else %}
  <p class="text-muted">
    Login to view contact details.
  </p>
{% endif %}

      </div>
    </div>

  </div>
</div>

{% if current_user.is_authenticated and current_user.id == item.user_id %}
  
  <a href="{{ url_for('items.edit_item', item_id=item.id) }}"
   class="btn btn-outline-primary mt-3 me-2">
  Edit Item
</a>

  {% if item.status == "active" %}
    <form method="POST"
          action="{{ url_for('items.mark_recovered', item_id=item.id) }}"
          class="d-inline">
      <button class="btn btn-success mt-3">
        Mark as Recovered
      </button>
    </form>
  {% else %}
    <span class="badge bg-success mt-3">Recovered</span>
  {% endif %}

  <!-- DELETE -->
  <form method="POST"
        action="{{ url_for('items.delete_item', item_id=item.id) }}"
        class="d-inline"
        onsubmit="return confirm('Are you sure you want to delete this item?');">
    <button class="btn btn-outline-danger mt-3 ms-2">
      Delete Item
    </button>
  </form>

{% endif %}



{% endblock %}




